<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://www.jiomart.com/msassets/favicon.svg?v2">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    <title>card</title>

    <style>
        .cart_active{
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: 0;
            width: 100%;
            height: 100vh;
            background-color: rgba(100, 100, 100, 0.5);
            z-index: 1000000;
        }
    </style>

    <!-- <style>
        nav {
            position: fixed;
            top: 0;
            z-index: 1000;
        }
    </style> -->

    <link rel="stylesheet" href="css/card.css">
    <link rel="stylesheet" href="styles/footer.css">
    <link rel="stylesheet" href="styles/header.css">


</head>

<body>
    <!-- <div class="header">
    </div> -->
    
    <div id="loading_screen" class="cart_active">
        <div class="text-center">
            <div class="spinner-border" style="width: 3rem; height: 3rem; color: aliceblue;" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
    </div>

    <nav></nav>

    <div id="container">
        <div class="card-title">
            <div id="card-count">
                <h2>My Card (<span id="total_items"></span>)</h2>
            </div>
            <div id="order-status">
                <ul>
                    <li><img src="https://www.jiomart.com/msassets/images/icons/cart_blue_active.svg" alt="">
                        <span>Your
                            card</span>
                    </li>
                    <li> <img src="	https://www.jiomart.com/msassets/images/icons/orders_review_inactive.svg" alt="">
                        <span> order Summary</span>
                    </li>
                    <li><img src="https://www.jiomart.com/msassets/images/icons/payment_inactive.svg" alt="">
                        <span>Payment</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="container-boxleft">

            <div class="cart-product">
                <div class="cart-product-name">
                    <div class="product-name">
                        <h3>Basket</h3>
                    </div>
                    <div class="amount">
                        <h3 id="available-amt"></h3>
                    </div>
                </div>


                <div class="product-details">
                    <div class="product-itemsdetails">
                        <!-- <div class="product-img">
                            <img src="https://www.jiomart.com/images/product/75x75/490002339/closeup-everfresh-red-hot-triple-fresh-formula-toothpaste-80-g-product-images-o490002339-p490002339-0-202203170622.jpg"
                                alt="">
                        </div>

                        <div class='product-itemsName'>
                            <h4>Closeup Everfresh+ Red Hot Triple Fresh Formula Toothpaste 80 g</h4>
                            <div>
                                <div class="product-itemsPrice">
                                    <span id="special-price">₹44.00</span>
                                    <span id="mrp-price">₹48.00</span>
                                    <span id="save-price">You Save ₹4.00</span>
                                </div>
                                <div class="product-qty">

                                    <span><img src="https://www.jiomart.com/msassets/images/icons/minus-bulecolor.svg"
                                            alt=""></span>
                                    <span id="qty">1</span>
                                    <span><img src="https://www.jiomart.com/msassets/images/icons/plus-bluecolor.svg"
                                            alt=""></span>
                                </div>

                            </div>
                        </div> -->
                    </div>
                    <!-- <hr> -->
                </div>



            </div>


            <div id="container-boxRight">

                <!-- <div class="dis-Coupon"> -->
                <div id="applypromo">

                    <div>
                        <h4>Apply Coupon</h4>
                        <span><a href="#">VIEW ALL</a></span>
                    </div>
                    <div>
                        <p><a href="">Login In</a> to see best offers and cashback deals</p>
                    </div>

                </div>

                <!-- </div> -->

                <div class="Payment-box">


                    <div id="payment-detials">
                        <h4>Payment Detials</h4>

                        <div>
                            <label> MRP Total</label>
                            <span class="span-right" id="mrp">0</span>
                            <hr>
                        </div>

                        <div>

                            <label>Product Discount</label>
                            <span class="span-right" id="dis-Coupon">0</span>
                            <hr>
                        </div>

                        <div>
                            <span>Total Amount</span>
                            <span class="span-right" id="tota-price">0</span>
                        </div>
                        <div>
                            <label>You Save <span id="total-save">0</span></label>
                        </div>

                    </div>

                    <div id="checkOut-btn">
                        <a href="review.html"> <button id="btn-checkout">Place Order</button></a>
                    </div>
                </div>


            </div>


        </div>


        <footer></footer>


</body>

</html>

<script src="scripts/card.js"></script>

<script type="module">
    import header from './scripts/header.js';
    import footer from './scripts/footer.js';

    let footer_div = document.querySelector('footer');
    let nav = document.querySelector('nav');
    


    setTimeout(() => {
            document.getElementById('loading_screen').style.display = "none";
        }, 1500);


    footer_div.innerHTML = footer();
    nav.innerHTML = header();
    nav.style.width = "100%";
    footer_div.style.width = "100%";


    let display_pin = document.getElementById('pin');

    currentLocation();

    let count_display = document.getElementById('cart_counter');
    let cart_count;
    let sibtn = document.getElementById('si_btn');
    let sitext = document.getElementById('acctext');

    let signUpData = JSON.parse(localStorage.getItem('signupData'));

    if(signUpData !== null){
    sitext.innerText = signUpData.firstname + signUpData.lastname;
    sibtn.href = "accountdetails.html";
}


    displayCount();

    function counter() {
        cart_count += 1;
        localStorage.setItem('count', JSON.stringify(cart_count));
        displayCount();
    }

    function displayCount() {
        cart_count = JSON.parse(localStorage.getItem('count')) || 0;
        count_display.innerText = +cart_count;
    }


    function currentLocation() {
        const options = {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0
        };

        async function success(pos) {
            const crd = pos.coords;
            // console.log(crd);

            let res = await fetch(`https://api.openweathermap.org/geo/1.0/reverse?lat=${crd.latitude}&lon=${crd.longitude}&limit=5&appid=63c3704e63cc40d74ad87bdb9f68f3b8`);
            let data = await res.json();
            let city = data[0].name;
            // console.log(city)

            let res2 = await fetch(`https://api.postalpincode.in/postoffice/${city}`);
            let data2 = await res2.json();
            console.log(data2[0].PostOffice[0].Pincode)
            display_pin.innerText = data2[0].PostOffice[0].Pincode;
        }


        function error(err) {
            console.warn(`ERROR(${err.code}): ${err.message}`);
        }

        navigator.geolocation.getCurrentPosition(success, error, options);
    }

</script>